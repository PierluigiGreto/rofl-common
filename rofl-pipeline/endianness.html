<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ROFL-pipeline: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ROFL-pipeline
   &#160;<span id="projectnumber">v0.6.0dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="endianness_title"></a>
Endianness clarifications</h1>
<h2><a class="anchor" id="endiannes_subtitle"></a>
Endianness of packet's header values, matches and actions:</h2>
<p>The rofl-pipeline library is designed to work with packet header values in a specially aligned Network Byte Order (NBO).</p>
<p>The reason for that lays in improving the performance of accessing those values in the packet headers. The spirit is to minimize the operations necessary to access those values(e.g. avoid unnecessary shifts). For this reason all the packet header values remain in NBO. The values that do not fill a standard type (u8, u16, u32 and u64) are stored in the lower part of the memory and properly masked.</p>
<p>This alignment is kept internally in the library. The functions to initialize (constructors) entry matches and actions must provide the values in Host Byte Order(HBO) always. Special getter functions return the HBO representation for convenience (e.g. <a class="el" href="group__core__of1x.html#ga71cbc34157e7d30fa62f6ce04d331527">of1x_get_match_value16()</a>, <a class="el" href="group__core__of1x.html#gab840ac1852d81bfad32f260187def135">of1x_get_match_mask8()</a> or <a class="el" href="group__core__of1x.html#ga35d1a64b7c380093073f428a6fdec108">of1x_get_packet_action_field64()</a>) Nevertheless the interface for accessing the packet header values (<a class="el" href="packet_8h.html" title="Defines the interface for packet mangling. The user of the library MUST provide an implementation for...">rofl/datapath/pipeline/platform/packet.h</a>), part of the <a class="el" href="group__core__pp.html">Software Packet Processing (pp) APIs</a>, uses this special alignment for the performance reasons already mentioned.</p>
<p>Following you may find a detailed explanation of them:</p>
<p>All the matches, actions and other values that do not external to packet (port_in, port_phy_in, metadata, queue and packet length) are kept in Host Byte Order(HBO).</p>
<p>For the rest of the values that are extracted (get) or modified (set) on packet headers, Network Byte Order is used. The non complete values have an special alignment explained here:</p>
<ul>
<li>mac address (6 bytes): Passed as an u64 variable where the 6 lower bytes are occupied with the mac address in NBO and the upper 2 are empty. Example: <br/>
<div class="fragment"><div class="line">mac_addr = 0x112233445566 </div>
</div><!-- fragment --> -&gt; in memory:<div class="fragment"><div class="line">uint_8* mac[8] = {0x11,0x22,0x33,0x44,0x55,0x66,0x00,0x00} </div>
</div><!-- fragment --> <br/>
 which is represented in a BE machine as<div class="fragment"><div class="line">0x1122334455660000 </div>
</div><!-- fragment --> and in a LE machine as<div class="fragment"><div class="line">0x0000665544332211 </div>
</div><!-- fragment --> <br/>
</li>
<li>vlan vid (12 bits): Passed as an u16 variable where the vid lays in the upper 12 bits in NBO and the 4 lower bits are empty. Example: <br/>
<div class="fragment"><div class="line">vlan_vid = 0x234 </div>
</div><!-- fragment --> -&gt; in memory<div class="fragment"><div class="line">uint_8* vid[2] = {0x02,0x34} </div>
</div><!-- fragment --> <br/>
 which is represented in a BE machine as<div class="fragment"><div class="line">0x0234 </div>
</div><!-- fragment -->, and in a LE machine as<div class="fragment"><div class="line">0x3402 </div>
</div><!-- fragment --> <br/>
</li>
<li>vlan pcp (3 bits) Passed as an u8 variable where the pcp lays in the upper 3 bits and the 5 lower bits are empty. Example: <br/>
<div class="fragment"><div class="line">vlan_pcp = 0x7 </div>
</div><!-- fragment --> -&gt; in memory<div class="fragment"><div class="line">uint_8* vid[1] = {0xE0} </div>
</div><!-- fragment --> <br/>
 which is represented in as<div class="fragment"><div class="line">0xE0 </div>
</div><!-- fragment --></li>
<li>mpls label (20 bits): Passed as an u32 variable where the label lays in the lower 20 bits and the upper 12 are empty. Example: <br/>
<div class="fragment"><div class="line">mpls_label = 0x12345 </div>
</div><!-- fragment --> -&gt; in memory:<div class="fragment"><div class="line">uint_8* label[4] = {0x12,0x34,0x50,0x00} </div>
</div><!-- fragment --> <br/>
 which is represented in a BE machine as<div class="fragment"><div class="line">0x12345000 </div>
</div><!-- fragment --> and in a LE machine as<div class="fragment"><div class="line">0x00503412 </div>
</div><!-- fragment --> <br/>
</li>
<li>mpls tc (3 bits) Passed as an u8 variable where the tc lays in the 2nd to 4th bits and the other bits are empty. Example: <br/>
<div class="fragment"><div class="line">mpls_tc = 0x7 </div>
</div><!-- fragment --> -&gt; in memory<div class="fragment"><div class="line">uint_8* tc[1] = {0x0E} </div>
</div><!-- fragment --> <br/>
 which is represented in as<div class="fragment"><div class="line">0x0E </div>
</div><!-- fragment --></li>
<li>ip dscp (6 bytes) Passed as an u8 variable where the dscp lays in the upper 6 bits and the lower 2 bits are empty. Example: <br/>
<div class="fragment"><div class="line">ip_dscp = 0x3F </div>
</div><!-- fragment --> -&gt; in memory<div class="fragment"><div class="line">uint_8* dscp[1] = {0xFC} </div>
</div><!-- fragment --> <br/>
 which is represented in as<div class="fragment"><div class="line">0xFC </div>
</div><!-- fragment --></li>
<li>ipv6 flow label (20 bits) Passed as an u32 variable where the flabel lays from the 4th to the 24th bits and the other 12 are empty. Example: <br/>
<div class="fragment"><div class="line">ipv6_flabel = 0x12345 </div>
</div><!-- fragment --> -&gt; in memory:<div class="fragment"><div class="line">uint_8* flabel[4] = {0x01,0x23,0x45,0x00} </div>
</div><!-- fragment --> <br/>
 which is represented in a BE machine as<div class="fragment"><div class="line">0x01234500 </div>
</div><!-- fragment --> and in a LE machine as<div class="fragment"><div class="line">0x00452301 </div>
</div><!-- fragment --> <br/>
</li>
<li>pbb isid (3 bytes): Passed as an u32 variable where the isid lays in the lower 3 bytes and the upper byte is empty. Example: <br/>
<div class="fragment"><div class="line">pbb_isid = 0x123456 </div>
</div><!-- fragment --> -&gt; in memory:<div class="fragment"><div class="line">uint_8* isid[4] = {0x12,0x34,0x56,0x00} </div>
</div><!-- fragment --> <br/>
 which is represented in a BE machine as<div class="fragment"><div class="line">0x12345600 </div>
</div><!-- fragment --> and in a LE machine as<div class="fragment"><div class="line">0x00563412 </div>
</div><!-- fragment --> <br/>
</li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
